<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Table Render</title>
</head>
<body>
    <h1>Test Table Rendering</h1>
    
    <button onclick="testDirectRender()">Test Direct Table Render</button>
    <button onclick="loadMainApp()">Load Main App in iFrame</button>
    
    <div id="results" style="margin: 20px; padding: 20px; background: #f0f0f0;"></div>
    
    <h2>Test Table</h2>
    <table border="1" style="width: 100%;">
        <thead>
            <tr>
                <th>Address</th>
                <th>City</th>
                <th>State</th>
                <th>Price</th>
            </tr>
        </thead>
        <tbody id="testTableBody">
            <tr><td colspan="4">Click button to test</td></tr>
        </tbody>
    </table>
    
    <h2>Main App in iFrame</h2>
    <iframe id="mainApp" src="/" style="width: 100%; height: 600px; border: 1px solid #ccc; display: none;"></iframe>
    
    <script>
        function testDirectRender() {
            const tbody = document.getElementById('testTableBody');
            const results = document.getElementById('results');
            
            // Clear table
            tbody.innerHTML = '';
            
            // Test data
            const testProperties = [
                { address: '123 Main St', city: 'Las Vegas', state: 'NV', price: 300000 },
                { address: '456 Oak Ave', city: 'Henderson', state: 'NV', price: 350000 },
                { address: '789 Pine Rd', city: 'Reno', state: 'NV', price: 275000 }
            ];
            
            // Render properties
            testProperties.forEach(prop => {
                const row = tbody.insertRow();
                row.innerHTML = `
                    <td>${prop.address}</td>
                    <td>${prop.city}</td>
                    <td>${prop.state}</td>
                    <td>$${prop.price.toLocaleString()}</td>
                `;
            });
            
            results.innerHTML = `
                <h3>✅ Direct Render Test Successful</h3>
                <p>Rendered ${testProperties.length} test properties</p>
                <p>If you see the properties above, table rendering works fine.</p>
            `;
        }
        
        function loadMainApp() {
            const iframe = document.getElementById('mainApp');
            iframe.style.display = 'block';
            
            // Wait for iframe to load
            iframe.onload = function() {
                const iframeDoc = iframe.contentDocument || iframe.contentWindow.document;
                const tbody = iframeDoc.getElementById('propertyTableBody');
                const results = document.getElementById('results');
                
                if (tbody) {
                    results.innerHTML += `
                        <h3>✅ Found propertyTableBody in main app</h3>
                        <p>Current content: ${tbody.innerHTML.substring(0, 100)}...</p>
                        <p>Number of rows: ${tbody.getElementsByTagName('tr').length}</p>
                    `;
                    
                    // Try to inspect the properties array
                    if (iframe.contentWindow.properties) {
                        results.innerHTML += `
                            <p>Properties array length: ${iframe.contentWindow.properties.length}</p>
                            <pre>${JSON.stringify(iframe.contentWindow.properties.slice(0, 2), null, 2)}</pre>
                        `;
                    }
                } else {
                    results.innerHTML += '<h3>❌ Could not find propertyTableBody in iframe</h3>';
                }
            };
        }
        
        // Also check the main window
        window.onload = function() {
            const results = document.getElementById('results');
            const mainTbody = document.getElementById('propertyTableBody');
            
            if (mainTbody) {
                results.innerHTML = '<h3>⚠️ Found propertyTableBody in THIS page (should not be here)</h3>';
            } else {
                results.innerHTML = '<h3>✅ propertyTableBody not in test page (correct)</h3>';
            }
        };
    </script>
</body>
</html>