<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Simple Click Test</title>
    <style>
        body { 
            font-family: Arial, sans-serif; 
            padding: 20px; 
        }
        .test-address {
            color: #667eea;
            text-decoration: underline;
            cursor: pointer;
            padding: 10px;
            display: inline-block;
            margin: 10px;
        }
        .test-address:hover {
            background: #f0f0f0;
        }
        .modal {
            display: none;
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: white;
            border: 2px solid #333;
            padding: 20px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.3);
            z-index: 1000;
        }
        .log {
            background: #f5f5f5;
            padding: 10px;
            margin: 10px 0;
            border: 1px solid #ddd;
            font-family: monospace;
            font-size: 12px;
            max-height: 200px;
            overflow-y: auto;
        }
    </style>
</head>
<body>
    <h1>Simple Click Test</h1>
    
    <h2>Test 1: Basic Event Delegation</h2>
    <div id="test1Container">
        <!-- Content will be added dynamically -->
    </div>
    <div id="test1Log" class="log"></div>
    
    <h2>Test 2: Same Structure as Main App</h2>
    <table>
        <tbody id="test2Container">
            <!-- Content will be added dynamically -->
        </tbody>
    </table>
    <div id="test2Log" class="log"></div>
    
    <div id="testModal" class="modal">
        <h3>Modal Opened!</h3>
        <p id="modalContent"></p>
        <button onclick="closeTestModal()">Close</button>
    </div>
    
    <script>
        const logs = { test1: [], test2: [] };
        
        function log(test, message) {
            const time = new Date().toLocaleTimeString();
            logs[test].push(`[${time}] ${message}`);
            updateLog(test);
        }
        
        function updateLog(test) {
            const logEl = document.getElementById(`${test}Log`);
            logEl.innerHTML = logs[test].join('<br>');
            logEl.scrollTop = logEl.scrollHeight;
        }
        
        // Test 1: Basic event delegation
        function setupTest1() {
            const container = document.getElementById('test1Container');
            
            // Add content
            container.innerHTML = `
                <div>Click on addresses below:</div>
                <span data-action="show-property" data-index="0" class="test-address">123 Test Street</span>
                <span data-action="show-property" data-index="1" class="test-address">456 Demo Avenue</span>
                <span data-action="show-property" data-index="2" class="test-address">789 Example Road</span>
            `;
            
            // Set up event delegation
            container.addEventListener('click', function(e) {
                log('test1', `Container clicked, target: ${e.target.tagName}, class: ${e.target.className}`);
                
                if (e.target.hasAttribute('data-action') && e.target.getAttribute('data-action') === 'show-property') {
                    const index = e.target.getAttribute('data-index');
                    log('test1', `✓ Property clicked! Index: ${index}`);
                    showTestModal(`Test 1 - Property ${index}`);
                }
            });
            
            log('test1', 'Event delegation set up on container');
        }
        
        // Test 2: Same structure as main app
        function setupTest2() {
            const tbody = document.getElementById('test2Container');
            
            // Clear and add rows
            tbody.innerHTML = '';
            
            const properties = [
                { address: '111 Main St', city: 'Las Vegas', state: 'NV' },
                { address: '222 Oak Ave', city: 'Henderson', state: 'NV' },
                { address: '333 Pine Rd', city: 'Reno', state: 'NV' }
            ];
            
            properties.forEach((prop, index) => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>
                        <div style="display: flex; align-items: center; gap: 8px;">
                            <span data-action="show-property" 
                                  data-index="${index}"
                                  class="test-address"
                                  title="Click to view property details">${prop.address}</span>
                        </div>
                    </td>
                    <td>${prop.city}</td>
                    <td>${prop.state}</td>
                `;
                tbody.appendChild(row);
            });
            
            log('test2', `Added ${properties.length} rows to table`);
            
            // Set up event delegation on tbody
            tbody.addEventListener('click', function(e) {
                log('test2', `Table clicked, target: ${e.target.tagName}, data-action: ${e.target.getAttribute('data-action')}`);
                
                const target = e.target;
                if (target.hasAttribute('data-action') && target.getAttribute('data-action') === 'show-property') {
                    const index = target.getAttribute('data-index');
                    log('test2', `✓ Property clicked! Index: ${index}`);
                    showTestModal(`Test 2 - Property ${index}`);
                }
            });
            
            log('test2', 'Event delegation set up on tbody');
        }
        
        function showTestModal(content) {
            const modal = document.getElementById('testModal');
            document.getElementById('modalContent').textContent = content;
            modal.style.display = 'block';
            console.log('Modal shown with content:', content);
        }
        
        function closeTestModal() {
            document.getElementById('testModal').style.display = 'none';
        }
        
        // Initialize tests
        window.onload = function() {
            console.log('Initializing tests...');
            setupTest1();
            setupTest2();
            
            // Also test direct clicks
            setTimeout(() => {
                console.log('\n=== Direct Click Test ===');
                const firstAddress = document.querySelector('[data-action="show-property"]');
                if (firstAddress) {
                    console.log('Found first address:', firstAddress.textContent);
                    console.log('Triggering click programmatically...');
                    firstAddress.click();
                } else {
                    console.error('No address elements found!');
                }
            }, 1000);
        };
    </script>
</body>
</html>