<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Simple Modal Function Test</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            padding: 20px;
        }
        .test-section {
            margin: 20px 0;
            padding: 20px;
            border: 1px solid #ddd;
            border-radius: 8px;
        }
        button {
            margin: 5px;
            padding: 10px 20px;
            background: #3b82f6;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
        }
        button:hover {
            background: #2563eb;
        }
        .success { color: green; }
        .error { color: red; }
        pre {
            background: #f5f5f5;
            padding: 10px;
            border-radius: 4px;
            overflow-x: auto;
        }
    </style>
</head>
<body>
    <h1>Simple Modal Function Test</h1>
    
    <div class="test-section">
        <h2>1. Test Functions on Current Page</h2>
        <p>Open the browser console (F12) and check the output when clicking these buttons:</p>
        <button onclick="testFunction()">Test If Functions Exist</button>
        <button onclick="window.openAnalyzeModal && window.openAnalyzeModal()">Call openAnalyzeModal</button>
        <button onclick="window.generateMarketInsights && window.generateMarketInsights()">Call generateMarketInsights</button>
        <div id="results"></div>
    </div>
    
    <div class="test-section">
        <h2>2. Load index.html and Test</h2>
        <button onclick="loadAndTest()">Load index.html in iframe</button>
        <div id="iframeResults"></div>
    </div>
    
    <div class="test-section">
        <h2>3. Direct Console Commands to Try</h2>
        <pre>
// Copy and paste these into the console on index.html:

// Check if functions exist:
console.log('openAnalyzeModal exists?', typeof window.openAnalyzeModal);
console.log('generateMarketInsights exists?', typeof window.generateMarketInsights);

// Try calling them:
if (window.openAnalyzeModal) window.openAnalyzeModal();
if (window.generateMarketInsights) window.generateMarketInsights();

// Check for the modal elements:
console.log('analyzeModal exists?', !!document.getElementById('analyzeModal'));
console.log('marketInsightsModal exists?', !!document.getElementById('marketInsightsModal'));

// Find all onclick handlers:
Array.from(document.querySelectorAll('[onclick]')).forEach(el => {
    console.log(el.textContent.trim(), '->', el.getAttribute('onclick'));
});
        </pre>
    </div>
    
    <script>
        function testFunction() {
            const results = [];
            
            // Test on current window
            results.push('Testing on current window:');
            results.push(`window.openAnalyzeModal: ${typeof window.openAnalyzeModal}`);
            results.push(`window.generateMarketInsights: ${typeof window.generateMarketInsights}`);
            
            document.getElementById('results').innerHTML = '<pre>' + results.join('\n') + '</pre>';
        }
        
        function loadAndTest() {
            const iframe = document.createElement('iframe');
            iframe.src = 'index.html';
            iframe.style.width = '100%';
            iframe.style.height = '200px';
            iframe.style.border = '1px solid #ccc';
            
            const container = document.getElementById('iframeResults');
            container.innerHTML = '<p>Loading index.html...</p>';
            container.appendChild(iframe);
            
            iframe.onload = function() {
                const results = [];
                const iframeWindow = iframe.contentWindow;
                
                results.push('Testing in iframe window:');
                results.push(`openAnalyzeModal: ${typeof iframeWindow.openAnalyzeModal}`);
                results.push(`generateMarketInsights: ${typeof iframeWindow.generateMarketInsights}`);
                
                // Check for JavaScript errors
                try {
                    // Check if the script executed
                    results.push(`\nGlobal properties variable exists: ${typeof iframeWindow.properties !== 'undefined'}`);
                    
                    // Check modal elements
                    const analyzeModal = iframeWindow.document.getElementById('analyzeModal');
                    const marketModal = iframeWindow.document.getElementById('marketInsightsModal');
                    
                    results.push(`\nModal elements:`);
                    results.push(`analyzeModal exists: ${!!analyzeModal}`);
                    results.push(`marketInsightsModal exists: ${!!marketModal}`);
                    
                    // Find buttons
                    const buttons = iframeWindow.document.querySelectorAll('button[onclick*="Analyze"], button[onclick*="Market"]');
                    results.push(`\nButtons with Analyze/Market onclick: ${buttons.length}`);
                    buttons.forEach(btn => {
                        results.push(`- "${btn.textContent.trim()}" -> ${btn.getAttribute('onclick')}`);
                    });
                    
                } catch (error) {
                    results.push(`\nError accessing iframe content: ${error.message}`);
                }
                
                container.innerHTML = '<pre>' + results.join('\n') + '</pre>' + 
                    '<p style="margin-top: 10px;">iframe loaded below:</p>';
                container.appendChild(iframe);
            };
            
            iframe.onerror = function() {
                container.innerHTML = '<p class="error">Error loading index.html</p>';
            };
        }
    </script>
</body>
</html>